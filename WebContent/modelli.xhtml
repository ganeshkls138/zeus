<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">
<h:head>
 	<title>Zeus - Modelli di caricamento articoli</title>
 	<link rel="shortcut icon" type="image/x-icon" href="#{request.contextPath}/images/favicon.ico"/>
 	<link href="css/zeus.css" rel="stylesheet" type="text/css" />
	 <style>
		.ui-widget {
			font-size: 14px !important;
			font-family: calibri;
		}
	 </style>
</h:head>
<h:body>
 		<div class="divNorth">
	    	<ui:include page="menubar.xhtml" />
	    </div>
	
		<div class="divCenter">	
	        <h:form id="form" prependId="false">
	           
	           <div class="div800">	
	           
	           	   <p:growl id="growl" showDetail="true"/>  
	           	   
	           	   <div style="margin-bottom: 5px; height:35px;">
	           	   		<div style="float:left">
	           	   			<h:outputLink target="_blank" value="https://sellercentral.amazon.it/gp/item-manager/ezdpc/uploadInventory.html/ref=ag_invfile_dnav_home_">
	           	   				Pagina caricamento mcd Amazon
	           	   			</h:outputLink>
	           	   		</div>
	           	   
						<div style="float:right">
							<p:commandButton value="Unifica Modelli Yatego" id="unificaModYat" action="#{modelliBean.unificaModelliYatego}" update=":form"/>
						</div>
					</div>
	           
		           <h3>Da caricare</h3>  
					<p:dataTable value="#{modelliBean.modelliDaCaricare}" var="dom" id="tabellaDaCaricare" emptyMessage="Nessun file trovato."> 
						
						<p:column headerText="#">
							#{dom[0]}
						</p:column>
						
						<p:column headerText="Nome file">
							<p:commandLink value="#{dom[2]}" action="#{modelliBean.ottieniValori}" oncomplete="modDialog.show()" update=":form:dialogModello">
								<f:setPropertyActionListener target="#{modelliBean.percorsoFileSelezionato}" value="#{dom[1]}" />
							    <f:setPropertyActionListener target="#{modelliBean.nomeFileSelezionato}" value="#{dom[2]}" />
								#{dom[2]}
							</p:commandLink>
						</p:column>
						
						<p:column headerText="Scarica" style="text-align:center">
						 	<p:commandButton id="downloadButton" ajax="false" icon="ui-icon-arrowthickstop-1-s"> 
						 		<f:setPropertyActionListener target="#{modelliBean.percorsoFileSelezionato}" value="#{dom[1]}" />
							    <f:setPropertyActionListener target="#{modelliBean.nomeFileSelezionato}" value="#{dom[2]}" />
								<p:fileDownload value="#{modelliBean.file}"/>  
							</p:commandButton>
						</p:column>
						
						<p:column headerText="Imposta come caricato"  style="text-align:center">
							<p:commandButton id="checkButton" icon="ui-icon-check" action="#{modelliBean.impostaCaricato}" widgetVar="cb"
									update=":form" onclick="cb.hide()" oncomplete="cb.show()" ajax="true">
								<f:setPropertyActionListener target="#{modelliBean.percorsoFileSelezionato}" value="#{dom[1]}" />
							    <f:setPropertyActionListener target="#{modelliBean.nomeFileSelezionato}" value="#{dom[2]}" />
							</p:commandButton> 
							
							<p:blockUI block="tabellaDaCaricare" trigger="checkButton" >  
						        Operazione in corso...<br />  
						        <p:graphicImage value="images/ajax-loader.gif"/>  
						    </p:blockUI> 
						</p:column>
						
						<p:column headerText="Elimina"  style="text-align:center">
							<p:commandButton id="elimButton1" icon="ui-icon-close" update=":form:dialogElimina" oncomplete="confElimina.show()">
								<f:setPropertyActionListener target="#{modelliBean.percorsoFileSelezionato}" value="#{dom[1]}" />
							    <f:setPropertyActionListener target="#{modelliBean.nomeFileSelezionato}" value="#{dom[2]}" />
							</p:commandButton> 
						</p:column>
					 
					</p:dataTable> 
	              
					
					
					<h3>Ultimi caricati</h3>  
					<p:dataTable value="#{modelliBean.modelliCaricati}" var="led" id="tabellaCaricati" emptyMessage="Nessun file trovato." paginator="true" rows="10" > 
						<p:column headerText="Nome file" sortBy="#{led[2]}">
							#{led[2]}
						</p:column>
						
						<p:column headerText="Elimina"  style="text-align:center">
							<p:commandButton id="elimButton2" icon="ui-icon-close" update=":form:dialogElimina" oncomplete="confElimina.show()">
								<f:setPropertyActionListener target="#{modelliBean.percorsoFileSelezionato}" value="#{led[1]}" />
							    <f:setPropertyActionListener target="#{modelliBean.nomeFileSelezionato}" value="#{led[2]}" />
							</p:commandButton>
						</p:column>	
										 
					</p:dataTable> 
					
					<p:dialog header="Conferma" widgetVar="confElimina" id="dialogElimina" showEffect="fade" hideEffect="explode" resizable="false" modal="true">  
						<p:panel id="panelElim" styleClass="panelNone">
							<h:outputText  value="Sicuro di voler eliminare #{modelliBean.nomeFileSelezionato} ?" /> 
							<br/> 
							<br/>
							<div style="width: 155px; margin: 0 auto;">
								<p:commandButton value="SÃ¬" icon="ui-icon-check" update=":form" 
					        		action="#{modelliBean.eliminaModello}" oncomplete="confElimina.hide()" id="eliminaYes"/>  
					        	&nbsp;
					        	<p:commandButton value="No" icon="ui-icon-close" oncomplete="confElimina.hide()"/>   
							</div>
						</p:panel>
					</p:dialog>   
					
					<br/>
					<br/>
					
					
					
				</div>
				
					<p:blockUI block="panelElim" trigger="eliminaYes" >  
					        Operazione in corso...<br />  
					        <p:graphicImage value="images/ajax-loader.gif"/>  
					</p:blockUI>    
				
					<p:blockUI block="tabellaDaCaricare" trigger="unificaModYat" >  
				        Operazione in corso...<br />  
				        <p:graphicImage value="images/ajax-loader.gif"/>  
				    </p:blockUI> 
				
					
				    
				   	<p:dialog header="Dettaglio Modello" widgetVar="modDialog" id="dialogModello"
						resizable="true" width="550" styleClass="dialog">
						<p:dataTable value="#{modelliBean.valoriModelloSelezionato}" var="modSel" paginator="true" rows="10"
							paginatorTemplate="{PreviousPageLink} {PageLinks} {NextPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
							currentPageReportTemplate="TOT: {totalRecords}"
							rowsPerPageTemplate="5,10,15,20,25">
							<p:column headerText="Codice" filterBy="#{modSel[0]}" filterMatchMode="contains">
								#{modSel[0]}							
							</p:column>
							<p:column headerText="Nome" filterBy="#{modSel[1]}" filterMatchMode="contains">
								#{modSel[1]}							
							</p:column>
						</p:dataTable>
					</p:dialog>
				
	        </h:form>
	        
    	</div>
                        
</h:body>
</html>
